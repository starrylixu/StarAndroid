ViewBinding封装基类(BaseActivity,BaseFragment)
[https://blog.csdn.net/jingzz1/article/details/105909040](https://blog.csdn.net/jingzz1/article/details/105909040)
封装DataBinding -- kotlin版
[https://juejin.cn/post/6957608813809795108](https://juejin.cn/post/6957608813809795108)
封装ViewModel
[https://juejin.cn/post/6962921719522656287](https://juejin.cn/post/6962921719522656287)
# 启用dataBinding
首先启用dataBinding的使用，在app的build.gradle中设置如下：
```groovy
android{
    dataBinding {
        enabled = true
    }
}
```
# 常规使用
## activity
在Activity中使用DataBinding时，通常是这样写：
```groovy
class MainActivity : AppCompatActivity() {
 private lateinit var mBinding:ActivityMainBinding
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
         mBinding = DataBindingUtil.setContentView<ActivityMainBinding>(this,R.layout.activity_main)
    }
}

```
## fragment
在fragment中使用DataBinding时，通过在onCreateView()中这样使用
```groovy
class HomeFragment:Fragment() {

    private lateinit var mBinding:FragmentMainBinding
    override fun onCreateView(
        inflater: LayoutInflater,
        container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        mBinding = DataBindingUtil.inflate(layoutInflater, R.layout.fragment_main,container,false)
        return mBinding.root
    }
}

```

# 封装Activity
这样的繁琐之处在于，每日创建一个新的activity和fragment都需要重写一遍。所以可以构建一个基类BaseActivity建立抽象层，使用泛型传入需要的ViewDataBinding对象VB，再通过抽象方法获取到Layout资源
经过这样的封装继承BaseActivity的新Activity都只需要重写一下三个抽象方法即可：
```groovy
initLayout();
initView();
initData();
```
```groovy

import android.content.Context;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;

import androidx.annotation.Nullable;
import androidx.appcompat.app.AppCompatActivity;
import androidx.databinding.DataBindingUtil;
import androidx.databinding.ViewDataBinding;

import com.eningqu.aipen.utils.ActivityController;

/**
 * Package:com.eningqu.aipen.ui.base
 * Author:starr
 * Time:2023/9/14  10:38
 * Description:基类Activity 封装DataBinding
 */
public abstract class BaseActivity<VB extends ViewDataBinding> extends AppCompatActivity {
    protected VB mBinding;
    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        initActivity();
    }


    /**
     * 获取布局id
     */
    protected abstract int getLayoutId();

    /**
     * 初始化控件
     */
    protected abstract void initView();

    /**
     * 初始化数据
     */
    protected abstract void initData();

    /**
     * 初始化布局
     */
    protected void initLayout(){
        mBinding= DataBindingUtil.inflate(
                LayoutInflater.from(this),
                getLayoutId(),
                null,
                false);
        setContentView(mBinding.getRoot());
    }
    /**
     * 初始化Activity
     */
    protected void initActivity(){
        initLayout();
        initView();
        initData();
    }

    public Context getContext(){
        return this;
    }
}

```
