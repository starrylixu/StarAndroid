# ğŸ€SmartRefreshLayoutå®ç°ä¸‹æ‹‰åˆ·æ–°ï¼Œä¸Šåˆ’åŠ è½½

æ³¨æ„ï¼šä¸æ˜¯æ•™ç¨‹åªæ˜¯ç¬”è®°ï¼Œå¦‚æœ‰é”™è¯¯æ¬¢è¿æ‰¹è¯„æŒ‡æ­£

æœ¬ä»½ç¬”è®°ä»£ç æ˜¯ç»§**ğŸ€ã€Androidã€‘5.0RecyclerViewåˆ—è¡¨ç»„ä»¶**

# ğŸå®˜ç½‘ç®€ä»‹

[SmartRefreshLayout: ä¸‹æ‹‰åˆ·æ–°ã€ä¸Šæ‹‰åŠ è½½ã€RefreshLayoutã€OverScrollï¼ŒAndroidæ™ºèƒ½ä¸‹æ‹‰åˆ·æ–°æ¡†æ¶ï¼Œæ”¯æŒè¶Šç•Œå›å¼¹ï¼Œå…·æœ‰æå¼ºçš„æ‰©å±•æ€§ï¼Œé›†æˆäº†å‡ åç§ç‚«é…·çš„Headerå’Œ Footerã€‚ (gitee.com)](https://gitee.com/scwang90/SmartRefreshLayout#english--%E4%B8%AD%E6%96%87)

SmartRefreshLayoutä»¥æ‰“é€ ä¸€ä¸ªå¼ºå¤§ï¼Œç¨³å®šï¼Œæˆç†Ÿçš„ä¸‹æ‹‰åˆ·æ–°æ¡†æ¶ä¸ºç›®æ ‡ï¼Œå¹¶é›†æˆå„ç§çš„ç‚«é…·ã€å¤šæ ·ã€å®ç”¨ã€ç¾è§‚çš„Headerå’ŒFooterã€‚ æ­£å¦‚åå­—æ‰€è¯´ï¼Œ`SmartRefreshLayout`æ˜¯ä¸€ä¸ªâ€œèªæ˜â€æˆ–è€…â€œæ™ºèƒ½â€çš„ä¸‹æ‹‰åˆ·æ–°å¸ƒå±€ï¼Œç”±äºå®ƒçš„â€œæ™ºèƒ½â€ï¼Œå®ƒä¸åªæ˜¯æ”¯æŒæ‰€æœ‰çš„Viewï¼Œè¿˜æ”¯æŒå¤šå±‚åµŒå¥—çš„è§†å›¾ç»“æ„ã€‚ å®ƒç»§æ‰¿è‡ª`ViewGroup` è€Œä¸æ˜¯`FrameLayout`æˆ–`LinearLayout`ï¼Œæé«˜äº†æ€§èƒ½ã€‚ ä¹Ÿå¸å–äº†ç°åœ¨æµè¡Œçš„å„ç§åˆ·æ–°å¸ƒå±€çš„ä¼˜ç‚¹ï¼ŒåŒ…æ‹¬è°·æ­Œå®˜æ–¹çš„ [SwipeRefreshLayout](https://gitee.com/link?target=https%3A%2F%2Fdeveloper.android.com%2Freference%2Fandroid%2Fsupport%2Fv4%2Fwidget%2FSwipeRefreshLayout.html)ï¼Œ å…¶ä»–ç¬¬ä¸‰æ–¹çš„ [Ultra-Pull-To-Refresh](https://gitee.com/link?target=https%3A%2F%2Fgithub.com%2Fliaohuqiu%2Fandroid-Ultra-Pull-To-Refresh)ã€[TwinklingRefreshLayout](https://gitee.com/link?target=https%3A%2F%2Fgithub.com%2Flcodecorex%2FTwinklingRefreshLayout) ã€‚ è¿˜é›†æˆäº†å„ç§ç‚«é…·çš„ Header å’Œ Footerã€‚

# ğŸŒºæ·»åŠ ä¾èµ–

è¿˜åŸå…ˆçš„recyclerviewå·¥ç¨‹ä¸‹çš„build.gradleä¸‹å¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼Œç„¶åç‚¹å‡»sync now

![](https://gitee.com/starry_lixu/picture/raw/master/20220426200844.png#id=rK6ZZ&originHeight=1032&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

```xml
 // æ³¨æ„ï¼šåˆ†åŒ…ä¹‹åä¸ä¼šæœ‰é»˜è®¤çš„Headerå’ŒFooteréœ€è¦æ‰‹åŠ¨æ·»åŠ ï¼è¿˜æ˜¯åŸæ¥çš„ä¸‰ç§æ–¹æ³•ï¼
    implementation  'com.scwang.smart:refresh-layout-kernel:2.0.1'      //æ ¸å¿ƒå¿…é¡»ä¾èµ–
    implementation  'com.scwang.smart:refresh-header-classics:2.0.1'    //ç»å…¸åˆ·æ–°å¤´
    implementation  'com.scwang.smart:refresh-header-radar:2.0.1'       //é›·è¾¾åˆ·æ–°å¤´
    implementation  'com.scwang.smart:refresh-header-falsify:2.0.1'     //è™šæ‹Ÿåˆ·æ–°å¤´
    implementation  'com.scwang.smart:refresh-header-material:2.0.1'    //è°·æ­Œåˆ·æ–°å¤´
    implementation  'com.scwang.smart:refresh-header-two-level:2.0.1'   //äºŒçº§åˆ·æ–°å¤´
    implementation  'com.scwang.smart:refresh-footer-ball:2.0.1'        //çƒè„‰å†²åŠ è½½
    implementation  'com.scwang.smart:refresh-footer-classics:2.0.1'    //ç»å…¸åŠ è½½
```

# ğŸ¥€åˆ›å»ºä¸€ä¸ª`SmartRefreshLayout`ç»„ä»¶

ä½¿ç”¨`SmartRefreshLayout`ï¼Œåœ¨xmlæ–‡ä»¶é‡Œåˆ›å»ºä¸€ä¸ª`SmartRefreshLayout`ç»„ä»¶ï¼Œå¹¶ç”¨å®ƒåŒ…è£¹ä½recyclerViewç»„ä»¶ï¼ŒåŒæ—¶ä¸ºå®ƒè®¾ç½®ä¸€ä¸ªidï¼Œæˆ‘è¿™é‡Œidå–åä¸º`refresh_parent`

![](https://gitee.com/starry_lixu/picture/raw/master/20220426202145.png#id=LYqRx&originHeight=1032&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

![](https://gitee.com/starry_lixu/picture/raw/master/20220426202411.png#id=M1BJo&originHeight=1032&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**activity_main.xmlå…³é”®ä»£ç **

```xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity">

    <com.scwang.smart.refresh.layout.SmartRefreshLayout
        android:id="@+id/refresh_parent"
        android:layout_width="match_parent"
        android:layout_height="500dp"
        app:layout_constraintTop_toTopOf="parent"
        app:layout_constraintLeft_toLeftOf="parent">

        <androidx.recyclerview.widget.RecyclerView
            android:id="@+id/recyclerView"
            android:layout_width="match_parent"
            android:layout_height="400dp"
            tools:layout_editor_absoluteX="1dp"
            tools:layout_editor_absoluteY="1dp"
            app:layout_constraintTop_toTopOf="parent"
            app:layout_constraintLeft_toLeftOf="parent"/>

    </com.scwang.smart.refresh.layout.SmartRefreshLayout>

</androidx.constraintlayout.widget.ConstraintLayout>
```

# ğŸŒ¼åœ¨Activityä¸­ä½¿ç”¨`SmartRefreshLayout`ç»„ä»¶

![](https://gitee.com/starry_lixu/picture/raw/master/20220426203856.png#id=a5jkc&originHeight=1032&originWidth=1920&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

é€šè¿‡idå±æ€§è·å–åˆ°`SmartRefreshLayout`ç»„ä»¶ï¼Œå¹¶è®¾ç½®å¤´éƒ¨å’Œå°¾éƒ¨çš„åˆ·æ–°æ ·å¼



**éƒ¨åˆ†å…³é”®ä»£ç **

```java
smartRefreshLayout=findViewById(R.id.refresh_parent);
//å¤´éƒ¨åˆ·æ–°æ ·å¼
smartRefreshLayout.setRefreshHeader(new ClassicsHeader(this));
//å°¾éƒ¨åˆ·æ–°æ ·å¼
smartRefreshLayout.setRefreshFooter(new ClassicsFooter(this));

smartRefreshLayout.setOnRefreshListener(new OnRefreshListener() {
    @Override
    public void onRefresh(@NonNull RefreshLayout refreshLayout) {

        //åˆ·æ–°å‰è¦æ¸…ç©ºåŸå…ˆçš„æ•°æ®
        chatList.clear();
        for(int i=0;i<10;++i){
            chat chats=new chat();
            chats.title="ä¸‹æ‹‰åˆ·æ–°"+i;
            chats.time="12:"+(10+i);
            chats.content="å¼€å¿ƒçš„ç¬¬"+i+"å¤©";
            chatList.add(chats);
        }
        /*é‡æ–°åˆ·æ–°åˆ—è¡¨æ§ä»¶çš„æ•°æ®*/
        myAdapter.notifyDataSetChanged();
        smartRefreshLayout.finishRefresh(2000);
    }
});

smartRefreshLayout.setOnLoadMoreListener(new OnLoadMoreListener() {
    @Override
    public void onLoadMore(@NonNull RefreshLayout refreshLayout) {
        for(int i=0;i<10;++i){
            chat chats=new chat();
            chats.title="ä¸Šæ‹‰æ›´å¤š"+i;
            chats.time="12:"+(10+i);
            chats.content="å¼€å¿ƒçš„ç¬¬"+i+"å¤©";
            chatList.add(chats);
        }
        /*é‡æ–°åˆ·æ–°åˆ—è¡¨æ§ä»¶çš„æ•°æ®*/
        myAdapter.notifyDataSetChanged();
        smartRefreshLayout.finishLoadMore(2000);

    }
});
```

![](https://gitee.com/starry_lixu/picture/raw/ca0234b8042312943ac7e7d1e7a43699688e4039/20220426205556.gif#id=iFJAJ&originHeight=1030&originWidth=1916&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

ä¿®æ”¹Headerå’ŒFooterçš„è®¾ç½®ä¸åŒçš„åˆ·æ–°æ ·å¼

![](https://gitee.com/starry_lixu/picture/raw/master/20220426205627.gif#id=eqdSp&originHeight=1030&originWidth=1916&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

```java
 //å¤´éƒ¨åˆ·æ–°æ ·å¼
smartRefreshLayout.setRefreshHeader(new BezierRadarHeader(this)
                                    .setEnableHorizontalDrag(true));
//å°¾éƒ¨åˆ·æ–°æ ·å¼
smartRefreshLayout.setRefreshFooter(new BallPulseFooter(this)
                                    .setSpinnerStyle(SpinnerStyle.FixedFront));
```

# ğŸŒ¾MainActivityå®Œæ•´ä»£ç 

```java
public class MainActivity extends AppCompatActivity {

    List<chat> chatList=new ArrayList<chat>();
    RecyclerView recyclerView;
    MyAdapter myAdapter;

    SmartRefreshLayout smartRefreshLayout;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        //è·å–recyclerView
        recyclerView=findViewById(R.id.recyclerView);
        //å¡«å……ä¸€äº›æ•°æ®
        for(int i=0;i<10;++i){
            chat chats=new chat();
            chats.title="ä¾¿ç­¾"+i;
            chats.time="12:"+(10+i);
            chats.content="å¼€å¿ƒçš„ç¬¬"+i+"å¤©";
            chatList.add(chats);
        }

        myAdapter=new MyAdapter();
        //å¡«å……å¸ƒå±€æ–‡ä»¶
        recyclerView.setAdapter(myAdapter);
        /*è®¾ç½®å¸ƒå±€æ–‡ä»¶çš„æ˜¾ç¤ºæ–¹å¼*/
        recyclerView.setLayoutManager(new LinearLayoutManager(this));

        smartRefreshLayout=findViewById(R.id.refresh_parent);
        //å¤´éƒ¨åˆ·æ–°æ ·å¼
        smartRefreshLayout.setRefreshHeader(new BezierRadarHeader(this)
                .setEnableHorizontalDrag(true));
        //å°¾éƒ¨åˆ·æ–°æ ·å¼
        smartRefreshLayout.setRefreshFooter(new BallPulseFooter(this)
                .setSpinnerStyle(SpinnerStyle.FixedFront));

        smartRefreshLayout.setOnRefreshListener(new OnRefreshListener() {
            @Override
            public void onRefresh(@NonNull RefreshLayout refreshLayout) {

                //åˆ·æ–°å‰è¦æ¸…ç©ºåŸå…ˆçš„æ•°æ®
                chatList.clear();
                for(int i=0;i<10;++i){
                    chat chats=new chat();
                    chats.title="ä¸‹æ‹‰åˆ·æ–°"+i;
                    chats.time="12:"+(10+i);
                    chats.content="å¼€å¿ƒçš„ç¬¬"+i+"å¤©";
                    chatList.add(chats);
                }
                /*é‡æ–°åˆ·æ–°åˆ—è¡¨æ§ä»¶çš„æ•°æ®*/
                myAdapter.notifyDataSetChanged();
                smartRefreshLayout.finishRefresh(1000);
            }
        });

        smartRefreshLayout.setOnLoadMoreListener(new OnLoadMoreListener() {
            @Override
            public void onLoadMore(@NonNull RefreshLayout refreshLayout) {
                for(int i=0;i<10;++i){
                    chat chats=new chat();
                    chats.title="ä¸Šæ‹‰æ›´å¤š"+i;
                    chats.time="12:"+(10+i);
                    chats.content="å¼€å¿ƒçš„ç¬¬"+i+"å¤©";
                    chatList.add(chats);
                }
                /*é‡æ–°åˆ·æ–°åˆ—è¡¨æ§ä»¶çš„æ•°æ®*/
                myAdapter.notifyDataSetChanged();
                smartRefreshLayout.finishLoadMore(1000);

            }
        });

    }

    /*æ³›å‹çš„ä½¿ç”¨ï¼Œè´Ÿè´£å°†å¸ƒå±€æ–‡ä»¶å¤åˆ¶næ¬¡*/
    public class MyAdapter extends RecyclerView.Adapter<MyViewHolder>{

        /*åŠ è½½å¹¶è¿”å›å¸ƒå±€æ–‡ä»¶   java->xml*/
        @NonNull
        @Override
        public MyViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
            View view= LayoutInflater.from(MainActivity.this).inflate(R.layout.item_chat,parent,false);
            MyViewHolder myViewHolder=new MyViewHolder(view);
            return myViewHolder;
        }
        /*å¡«å……ï¼Œä¿®æ”¹å¸ƒå±€é‡Œçš„æ§ä»¶å†…å®¹*/
        /*1.å¯ä»¥å°†æ•°æ®æå‰å¡«å……åˆ°ä¸€ä¸ªæ•°ç»„ä¸­
         * 2.é€šè¿‡æ•°ç»„çš„ä¸‹æ ‡è·å–åˆ°å€¼ï¼Œå¡«å……åˆ°æ§ä»¶ä¸­*/
        @Override
        public void onBindViewHolder(@NonNull MyViewHolder holder, int position) {

            chat chat=chatList.get(position);

            holder.textView1.setText(chat.title);
            holder.textView2.setText(chat.time);
            holder.textView3.setText(chat.content);
            holder.constraintLayout.setOnClickListener(
                    (view)->{
                        Intent intent=new Intent(MainActivity.this,MainActivity2.class);
                        startActivity(intent);
                    }
            );
        }
        /*å°†å¸ƒå±€å¤åˆ¶çš„æ¬¡æ•°ï¼Œè¿”å›å€¼ä¸ºitemæ˜¾ç¤ºçš„æ•°é‡*/
        @Override
        public int getItemCount() {
            return chatList.size();
        }
    }


    /*å¦‚ä½•è·å–åˆ°itemé‡Œçš„å†…å®¹ï¼Ÿï¼Ÿï¼Ÿ
     *
     * 1. åœ¨Activityä¸­åˆ›å»ºä¸€ä¸ªå†…éƒ¨ç±»*/
    /*åˆ›å»ºä¸€ä¸ªå†…éƒ¨ç±»ï¼Œç”¨äºè·å–item_chat.xmlä¸­çš„ç»„ä»¶*/
    public class MyViewHolder extends RecyclerView.ViewHolder{

        TextView textView1;
        TextView textView2;
        TextView textView3;
        ConstraintLayout constraintLayout;
        public MyViewHolder(@NonNull View itemView) {
            super(itemView);
            /*å¹¶ä¸æ˜¯ç›´æ¥ä½¿ç”¨findViewById,è€Œæ˜¯é€šè¿‡è°ƒç”¨itemView
             * å¦‚æœç›´æ¥ä½¿ç”¨findViewByIdï¼Œé»˜è®¤æ˜¯åœ¨MainActivityä¸­æŸ¥æ‰¾*/
            textView1 = itemView.findViewById(R.id.textView);
            textView2 = itemView.findViewById(R.id.textView2);
            textView3 = itemView.findViewById(R.id.textView3);
            constraintLayout=itemView.findViewById(R.id.rootView);
        }
    }

}
```
